{%- style -%}
.section-{{ section.id }}-padding {
  padding-top: {{ section.settings.padding_top | times: 0.50 | round: 0 }}px;
  padding-bottom: {{ section.settings.padding_bottom | times: 0.50 | round: 0 }}px;
}
@media screen and (min-width: 576px) and (max-width: 749px){
  .section-{{ section.id }}-padding {
    padding-top: {{ section.settings.padding_top | times: 0.75 | round: 0 }}px;
    padding-bottom: {{ section.settings.padding_bottom | times: 0.75 | round: 0 }}px;
  }
}
@media screen and (min-width: 750px) {
  .section-{{ section.id }}-padding {
    padding-top: {{ section.settings.padding_top }}px;
    padding-bottom: {{ section.settings.padding_bottom }}px;
  }
}
{%- endstyle -%}

<div class="video-popup-container section-{{ section.id }}-padding">
  <!-- Thumbnail with Play Button -->
  <div class="video-thumbnail">
    <img src="{{ settings.thumbnail_image | img_url: 'medium' | default: 'https://via.placeholder.com/640x360?text=Video+Thumbnail' }}" 
         alt="Video Thumbnail" class="thumbnail-image" width="640" height="360">
    <button class="play-button" onclick="openVideoPopup()">â–¶</button>
  </div>
</div>

<!-- Video Popup Modal -->
<div id="videoPopup" class="video-popup">
  <div class="video-popup-content">
    <span class="close" onclick="closeVideoPopup()">&times;</span>
    <iframe id="videoFrame" width="560" height="315" frameborder="0" allowfullscreen></iframe>
  </div>
</div>

<script>
  // Open the video popup
  function openVideoPopup() {
    var popup = document.getElementById("videoPopup");
    var videoFrame = document.getElementById("videoFrame");
    var videoUrl = "{{ settings.video_url }}"; // Dynamic video URL from settings
    videoFrame.src = videoUrl;
    popup.style.display = "block";
  }

  // Close the video popup
  function closeVideoPopup() {
    var popup = document.getElementById("videoPopup");
    var videoFrame = document.getElementById("videoFrame");
    videoFrame.src = ""; // Stop video when closing
    popup.style.display = "none";
  }

  // Close the popup if the user clicks outside of the content
  window.onclick = function(event) {
    var popup = document.getElementById("videoPopup");
    if (event.target == popup) {
      closeVideoPopup();
    }
  }
</script>

<style>
  /* Style the thumbnail container */
  .video-popup-container {
    position: relative;
    display: inline-block;
  }

  .video-thumbnail {
    position: relative;
  }

  .thumbnail-image {
    width: 100%;
    height: auto;
  }

  /* Play button style */
  .play-button {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: rgba(0, 0, 0, 0.5);
    color: white;
    border: none;
    font-size: 2rem;
    padding: 10px;
    cursor: pointer;
  }

  /* The Modal (popup) */
  .video-popup {
    display: none; /* Hidden by default */
    position: fixed;
    z-index: 1;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    overflow: auto;
    background-color: rgba(0, 0, 0, 0.7);
  }

  /* Modal content */
  .video-popup-content {
    position: relative;
    margin: 15% auto;
    background-color: #fff;
    padding: 20px;
    width: 80%;
    max-width: 800px;
  }

  /* Close button */
  .close {
    position: absolute;
    top: 10px;
    right: 20px;
    color: #000;
    font-size: 30px;
    font-weight: bold;
    cursor: pointer;
  }
</style>

{% schema %}
{
  "name": "t:sections.wpb-Video-popup.name",
  "tag": "section",
    "class": "section",
  "settings": [
    {
      "type": "image_picker",
      "id": "thumbnail_image",
      "label": "Thumbnail Image"
    },
    {
      "type": "url",
      "id": "video_url",
      "label": "Video URL",
      "default": "https://www.youtube.com/embed/your-video-id"
    },
    {
      "type": "number",
      "id": "padding_top",
      "label": "Padding Top",
      "default": 20
    },
    {
      "type": "number",
      "id": "padding_bottom",
      "label": "Padding Bottom",
      "default": 20
    }
  ],
  "presets": [
    {
      "name": "t:sections.video-pop-up.presets.name",
    }
  ]
}
{% endschema %}
